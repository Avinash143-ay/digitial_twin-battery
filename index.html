<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Actual vs Predicted - Voltage & Temperature</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
    <script src="app.js" defer></script>
  </head>
  <body>
    <main class="container">
      <header class="header">
        <div>
          <h1>Battery Forecasting System</h1>
          <p>Predict battery behavior or compare actual vs predicted values.</p>
        </div>
      </header>

      <div id="statusBar" class="status-bar">
        <span class="status-indicator">‚óè</span>
        <span id="statusText">Ready - Select a mode to begin</span>
      </div>

      <!-- Tab Navigation -->
      <div class="tabs">
        <button class="tab-btn active" data-tab="predict">üîÆ Predict Mode</button>
        <button class="tab-btn" data-tab="compare">üìä Compare Mode</button>
      </div>

      <!-- Predict Tab -->
      <div id="predictTab" class="tab-content active">
        <section class="card prediction-card">
          <h2>Initial Conditions</h2>
          <div class="param-grid">
            <div class="param-group">
              <label for="soh">SOH (State of Health)</label>
              <input type="number" id="soh" min="0" max="1" step="0.01" value="0.95" />
              <small>Range: 0.0 - 1.0</small>
            </div>
            <div class="param-group">
              <label for="voltage">Initial Voltage (V)</label>
              <input type="number" id="voltage" min="3.2" max="4.2" step="0.01" value="3.7" />
              <small>Range: 3.2 - 4.2 V</small>
            </div>
            <div class="param-group">
              <label for="temperature">Initial Temperature (¬∞C)</label>
              <input type="number" id="temperature" min="0" max="60" step="0.1" value="28" />
              <small>Typical: 25 - 35¬∞C</small>
            </div>
          </div>
          
          <div class="upload-section">
            <h3>Current Profile</h3>
            <p>Choose how to provide current data:</p>
            
            <div class="current-mode-selector">
              <label class="radio-option">
                <input type="radio" name="currentMode" value="constant" checked />
                <span>Constant Current</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="currentMode" value="csv" />
                <span>Upload CSV</span>
              </label>
            </div>

            <div id="constantCurrentSection" class="current-section">
              <div class="param-grid">
                <div class="param-group">
                  <label for="constantCurrent">Current Value (A)</label>
                  <input type="number" id="constantCurrent" min="-1.5" max="1.5" step="0.1" value="0.5" />
                  <small>-1.5 to 1.5 A (+ = discharge)</small>
                </div>
                <div class="param-group">
                  <label for="currentSteps">Duration (steps)</label>
                  <input type="number" id="currentSteps" min="10" max="150" step="10" value="150" />
                  <small>Each step = 2 seconds</small>
                </div>
              </div>
              <button id="generateCurrentBtn" class="generate-btn">Generate Current Profile</button>
            </div>

            <div id="csvCurrentSection" class="current-section" style="display: none;">
              <label class="upload-area">
                <input id="currentInput" type="file" accept=".csv,text/csv" />
                <div class="upload-content">
                  <span class="upload-icon">üìÅ</span>
                  <span class="upload-text">Choose Current CSV File</span>
                </div>
              </label>
            </div>

            <div id="currentInfo" class="file-info"></div>
          </div>

          <button id="predictBtn" class="predict-btn" disabled>
            <span>‚ö°</span>
            Predict Battery Behavior
          </button>
        </section>
      </div>

      <!-- Compare Tab -->
      <div id="compareTab" class="tab-content">
        <section class="card">
          <h2>Upload CSV for Comparison</h2>
          <p>Upload a CSV with columns: voltage_actual, voltage_median_pred, temperature_actual, temperature_median_pred</p>
          <label class="upload-area">
            <input id="csvInput" type="file" accept=".csv,text/csv" />
            <div class="upload-content">
              <span class="upload-icon">üìä</span>
              <span class="upload-text">Choose Comparison CSV</span>
            </div>
          </label>
        </section>
      </div>

      <section class="card">
        <div class="meta">
          <div>
            <h2>Voltage</h2>
            <p id="voltageSummary" class="summary">Waiting for data...</p>
          </div>
          <button id="downloadVoltage" class="ghost" disabled>Download PNG</button>
        </div>
        <div class="chart-wrap">
          <canvas id="voltageChart"></canvas>
        </div>
      </section>

      <section class="card">
        <div class="meta">
          <div>
            <h2>Temperature</h2>
            <p id="temperatureSummary" class="summary">Waiting for data...</p>
          </div>
          <button id="downloadTemperature" class="ghost" disabled>Download PNG</button>
        </div>
        <div class="chart-wrap">
          <canvas id="temperatureChart"></canvas>
        </div>
      </section>

      <section class="card help">
        <h3>CSV format example</h3>
        <pre>voltage_actual,voltage_median_pred,temperature_actual,temperature_median_pred
3.3,3.28,25.1,25.3
3.29,3.31,25.0,25.2</pre>
      </section>
    </main>
  </body>
</html>
